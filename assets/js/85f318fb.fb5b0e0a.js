"use strict";(self.webpackChunkcogment_doc=self.webpackChunkcogment_doc||[]).push([[4896],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),p=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return i.createElement(s.Provider,{value:t},e.children)},h="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),h=p(n),d=a,m=h["".concat(s,".").concat(d)]||h[d]||u[d]||r;return n?i.createElement(m,o(o({ref:t},c),{},{components:n})):i.createElement(m,o({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[h]="string"==typeof e?e:a,o[1]=l;for(var p=2;p<r;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2781:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var i=n(7462),a=(n(7294),n(3905));const r={title:"Step 1 - An Empty Cogment Application"},o="Set Up the Code & Test a Trial",l={unversionedId:"guide/tutorial/setup",id:"guide/tutorial/setup",title:"Step 1 - An Empty Cogment Application",description:"In this step of the tutorial, we will get the RPS code set up properly and test run a single trial. This will establish the basic working code needed for all subsequent steps of the tutorial. We will go over the components of the repository at a very high level. If any terminology is unclear, it may be useful to refer to the Core Concepts.",source:"@site/docs/guide/tutorial/1-setup.md",sourceDirName:"guide/tutorial",slug:"/guide/tutorial/setup",permalink:"/docs/guide/tutorial/setup",draft:!1,tags:[],version:"current",lastUpdatedAt:1696019767,formattedLastUpdatedAt:"Sep 29, 2023",sidebarPosition:1,frontMatter:{title:"Step 1 - An Empty Cogment Application"},sidebar:"docSidebar",previous:{title:"Tutorial",permalink:"/docs/guide/tutorial/"},next:{title:"Step 2 - Actors in Cogment",permalink:"/docs/guide/tutorial/actors-in-cogment"}},s={},p=[{value:"Getting Set Up",id:"getting-set-up",level:2},{value:"Cloning the RPS Source Code",id:"cloning-the-rps-source-code",level:3},{value:"Creating your development directory",id:"creating-your-development-directory",level:3},{value:"What&#39;s in this directory?",id:"whats-in-this-directory",level:2},{value:"Service Directories",id:"service-directories",level:3},{value:"Configuration &amp; Execution Files",id:"configuration--execution-files",level:3},{value:".env",id:"env",level:4},{value:"data.proto",id:"dataproto",level:4},{value:"cogment.yaml",id:"cogmentyaml",level:4},{value:"run.sh",id:"runsh",level:4},{value:"requirements.txt",id:"requirementstxt",level:4},{value:"services.yaml",id:"servicesyaml",level:4},{value:"Building the Application",id:"building-the-application",level:2},{value:"What exactly is happening in the install?",id:"what-exactly-is-happening-in-the-install",level:3},{value:"Running the Application",id:"running-the-application",level:2}],c={toc:p},h="wrapper";function u(e){let{components:t,...r}=e;return(0,a.kt)(h,(0,i.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"set-up-the-code--test-a-trial"},"Set Up the Code & Test a Trial"),(0,a.kt)("p",null,"In this step of the tutorial, we will get the RPS code set up properly and test run a single trial. This will establish the basic working code needed for all subsequent steps of the tutorial. We will go over the components of the repository at a very high level. If any terminology is unclear, it may be useful to refer to the ",(0,a.kt)("a",{parentName:"p",href:"/docs/guide/core-concepts"},"Core Concepts"),"."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"These instructions are for unix-like environments such as Linux, macOS and WSL2 on Windows.")),(0,a.kt)("h2",{id:"getting-set-up"},"Getting Set Up"),(0,a.kt)("p",null,"To begin with, you'll need a working installation of Cogment. If you haven't done so already, follow our ",(0,a.kt)("a",{parentName:"p",href:"/docs/reference/cli/"},"installation instructions"),"."),(0,a.kt)("p",null,"Additionally, you'll need:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.python.org/"},"Python")," (Cogment currently supports versions 3.7-3.9)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://virtualenv.pypa.io/en/latest/"},"virtualenv"))),(0,a.kt)("h3",{id:"cloning-the-rps-source-code"},"Cloning the RPS Source Code"),(0,a.kt)("p",null,"If you followed the test step of the installation instructions you have probably already downloaded the sources for the tutorial from the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/cogment/cogment-tutorial-rps"},"github repository"),". If not, now is the time to do so."),(0,a.kt)("p",null,"This repository contains completed code for each step of the tutorial in separate folders. If at any point you make a mistake and can't get something working, you can copy the code from the folder corresponding to the last step you completed to get a fresh starting point."),(0,a.kt)("h3",{id:"creating-your-development-directory"},"Creating your development directory"),(0,a.kt)("p",null,"First, let's make a new directory called ",(0,a.kt)("inlineCode",{parentName:"p"},"rps"),", and set this as our working directory. Unless otherwise mentioned, all operations for the rest of the tutorial are done from the ",(0,a.kt)("inlineCode",{parentName:"p"},"rps")," directory. We will then copy the code from the folder for step 1 of the tutorial from the directory ",(0,a.kt)("inlineCode",{parentName:"p"},"1-setup/"),", which contains a blank slate Cogment application as a starting point."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Execute the following commands in your terminal:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"mkdir rps\ncp -r <relative path to cloned repository>/basic_tutorial_steps/1-setup/ rps/\ncd rps\n")),(0,a.kt)("p",null,"We now have a starting point for developing the RPS project. This code copied from ",(0,a.kt)("inlineCode",{parentName:"p"},"basic_tutorial_steps/1-setup")," will run an empty Cogment application with two Actors able to play RPS."),(0,a.kt)("h2",{id:"whats-in-this-directory"},"What's in this directory?"),(0,a.kt)("h3",{id:"service-directories"},"Service Directories"),(0,a.kt)("p",null,"If we look at the elements of ",(0,a.kt)("inlineCode",{parentName:"p"},"rps"),", we will see 3 directories. Each directory contains the code required for managing that service, for now contained completely in a ",(0,a.kt)("inlineCode",{parentName:"p"},"main.py")," file that does all the work for that service. These services are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"environment/")," which specifies the dynamics of the game itself (what actions are allowed, what are the consequences of those actions),"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"actors/")," which specifies how the Actor(s) work -- what information they get from the environment, and how they use it for making a decision on what action to take next"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"trial_runner/")," which specifies how the Actors and Environment interact within Cogment, and launches the trials to run the games of RPS.")),(0,a.kt)("p",null,"At this stage, each module contains only the ",(0,a.kt)("inlineCode",{parentName:"p"},"main.py")," files. When we build the application, more files will be copied into each directory automatically."),(0,a.kt)("h3",{id:"configuration--execution-files"},"Configuration & Execution Files"),(0,a.kt)("p",null,"The root of the ",(0,a.kt)("inlineCode",{parentName:"p"},"rps")," directory also contains files which set the necessary configurations for running the application (",(0,a.kt)("inlineCode",{parentName:"p"},".env"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"data.proto"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"cogment.yaml"),"), as well as the ",(0,a.kt)("inlineCode",{parentName:"p"},"run.sh"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"requirements.txt")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"services.yaml")," files, which contain all the functions necessary for installing dependencies and running the Cogment project."),(0,a.kt)("h4",{id:"env"},".env"),(0,a.kt)("p",null,'This file is used to set environment variables. (Note that "environment" in this context refers to the operating system environment, which is not related to the concept of the Environment in the RL or Cogment context.) The variables set in this file specify configurations that are known to all parts of the application while it is running. The ',(0,a.kt)("inlineCode",{parentName:"p"},".env")," file is used in this project to specify the TCP ports through which different Cogment services (such as Actors or the Environment) can be accessed."),(0,a.kt)("h4",{id:"dataproto"},"data.proto"),(0,a.kt)("p",null,"In Cogment, we use ",(0,a.kt)("a",{parentName:"p",href:"https://developers.google.com/protocol-buffers/"},"Protocol Buffers")," to serialize data for communication across different services. In this project, the structure of these protobuf messages are defined in the file ",(0,a.kt)("inlineCode",{parentName:"p"},"data.proto"),". This file does most of the heavy lifting in creating data structures in Python and setting variables to the relevant parameter values (more on this later). The application 'knows' to use the messages defined here by importing it in the ",(0,a.kt)("inlineCode",{parentName:"p"},"cogment.yaml")," configuration file."),(0,a.kt)("h4",{id:"cogmentyaml"},"cogment.yaml"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"cogment.yaml")," file specifies all of the details about how the trials will be implemented. In particular, this file defines what protobuf messages the Environment and Actor(s) participating in the trial will expect and use as inputs and outputs. More information about what kinds of information can/should be included in a Spec File such as ",(0,a.kt)("inlineCode",{parentName:"p"},"cogment.yaml")," can be found on the ",(0,a.kt)("a",{parentName:"p",href:"/docs/reference/cogment-yaml"},"Spec File reference page"),"."),(0,a.kt)("h4",{id:"runsh"},"run.sh"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"run.sh")," file acts as the main command menu for the Cogment project: it contains all of the functions necessary for building and running the code."),(0,a.kt)("h4",{id:"requirementstxt"},"requirements.txt"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"requirements.txt")," file tells the Python package manager what packages need to be installed for this project to work. If we want any non-standard Python packages to run our application, we will specify them here and the package manager will install them in the virtual environment. For now, this file specifies we only need to install the most recent version of the Cogment Python SDK."),(0,a.kt)("h4",{id:"servicesyaml"},"services.yaml"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"services.yaml")," file is passed to the Cogment CLI utility command ",(0,a.kt)("inlineCode",{parentName:"p"},"launch"),". For the purposes of this tutorial, it's sufficient to understand that the contents of the ",(0,a.kt)("inlineCode",{parentName:"p"},"services.yaml")," file describe a set of processes to be run in parallel - with the additional condition that once any of these processes terminate, the others will terminate as well. More information about the ",(0,a.kt)("inlineCode",{parentName:"p"},"launch")," process can be found on the ",(0,a.kt)("a",{parentName:"p",href:"/docs/reference/cli/launch"},"Launch reference page"),"."),(0,a.kt)("h2",{id:"building-the-application"},"Building the Application"),(0,a.kt)("p",null,"To get all this code to work together, we will need to run the ",(0,a.kt)("inlineCode",{parentName:"p"},"install")," process in the ",(0,a.kt)("inlineCode",{parentName:"p"},"run.sh")," file."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"In your terminal run the ",(0,a.kt)("inlineCode",{parentName:"strong"},"install")," process with:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"./run.sh install\n")),(0,a.kt)("h3",{id:"what-exactly-is-happening-in-the-install"},"What exactly is happening in the install?"),(0,a.kt)("p",null,"We can understand what the ",(0,a.kt)("inlineCode",{parentName:"p"},"install")," function does by taking a closer look at the ",(0,a.kt)("inlineCode",{parentName:"p"},"run.sh")," file. You'll see that this function does the following:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Creates a virtual environment and installs Cogment and any required Python packages there"),(0,a.kt)("li",{parentName:"ul"},"Runs the Cogment Python code generation tool to make the files ",(0,a.kt)("inlineCode",{parentName:"li"},"cog_settings.py")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"data_pb2.py")," which are used by the Python SDK to know about the configurations and data structures which will be used in the application (more on this below).")),(0,a.kt)("p",null,"Now everything is set up to start the application."),(0,a.kt)("h2",{id:"running-the-application"},"Running the Application"),(0,a.kt)("p",null,"Now that we have built all the necessary components, we want to make sure the application can run."),(0,a.kt)("p",null,"We will need two terminals open:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"A terminal to run the services. Those services are the ",(0,a.kt)("inlineCode",{parentName:"li"},"environment"),", the ",(0,a.kt)("inlineCode",{parentName:"li"},"actors"),", and the ",(0,a.kt)("a",{parentName:"li",href:"/docs/reference/cli/orchestrator"},"Cogment Orchestrator"),", which is responsible for coordinating the services together."),(0,a.kt)("li",{parentName:"ul"},"A terminal to run the client that connects to the services in order to run the ",(0,a.kt)("a",{parentName:"li",href:"/docs/guide/core-concepts#trials"},"trial"),". This client is the ",(0,a.kt)("inlineCode",{parentName:"li"},"trial_runner"),".")),(0,a.kt)("p",null,"We need to have the services running already before the Trial Runner can connect. ",(0,a.kt)("strong",{parentName:"p"},"In the first terminal, start the Cogment app services with the command:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"./run.sh services_start\n")),(0,a.kt)("p",null,"This command starts the services named in the ",(0,a.kt)("inlineCode",{parentName:"p"},"services.yaml")," file. You should see something like:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"services_start",src:n(7388).Z,width:"2366",height:"368"})),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"In the second terminal, start the Trial Runner with the command:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"./run.sh trial_runner_start\n")),(0,a.kt)("p",null,"At this stage, the Trial Runner starts the trial, lets it run for a few seconds, and then terminates the trial. In the second terminal, you will see something like:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"trial runner_start",src:n(7860).Z,width:"2366",height:"128"})),(0,a.kt)("p",null,"In our application services terminal, this will also generate some logs reporting what happened. You should see something like this:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"services running",src:n(2247).Z,width:"2366",height:"694"})),(0,a.kt)("p",null,"At this point, both the action strings received by the Environment and the Observations received by the Actors are empty. In the next steps of the tutorial, we will add them in."),(0,a.kt)("p",null,"You can now terminate the services using ",(0,a.kt)("inlineCode",{parentName:"p"},"ctrl+C"),". At this point we have a working but empty Cogment app."),(0,a.kt)("details",null,(0,a.kt)("summary",null,(0,a.kt)("b",null,(0,a.kt)("span",{style:{fontSize:"20px"}},"Quick Summary"))),(0,a.kt)("p",null,"We got the RPS code from the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/cogment/cogment-tutorial-rps"},"github repository"),", and created a new directory ",(0,a.kt)("inlineCode",{parentName:"p"},"rps")," to work from."),(0,a.kt)("p",null,"We ran"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"./run.sh install\n")),(0,a.kt)("p",null,"to build the necessary elements to get the app up and running."),(0,a.kt)("p",null,"In one terminal, we started the ",(0,a.kt)("inlineCode",{parentName:"p"},"orchestrator"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"environment"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"actors")," services with:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"./run.sh services_start\n")),(0,a.kt)("p",null,"In a second terminal, we started the trial runner to begin a trial with:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"./run.sh client_start\n")),(0,a.kt)("p",null,"The client terminal printed the start and end of the trial, and the services trial reported some empty actions.")),(0,a.kt)("p",null,"In ",(0,a.kt)("a",{parentName:"p",href:"/docs/guide/tutorial/actors-in-cogment"},"the next step"),", we will look a little more closely at how Cogment represents the Actors, and enable them to select ",(0,a.kt)("inlineCode",{parentName:"p"},"ROCK"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"PAPER"),", or ",(0,a.kt)("inlineCode",{parentName:"p"},"SCISSORS")," rather than empty actions."))}u.isMDXComponent=!0},2247:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/services_running_1-8e7a67370095d320c207bb562c27c249.png"},7388:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/services_start-882fdc24a1ae68c55e4f485123b89dfc.png"},7860:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/trial_runner_start-9224103aebfb4e25fd34b0225cc20fee.png"}}]);