<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Step 4: Create a heuristic player - Cogment</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../../css/theme.css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Step 4: Create a heuristic player";
    var mkdocs_page_input_path = "cogment/tutorial/4-heuristic-player.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Cogment</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">Introduction</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../..">Overview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../introduction/installation/">Installation & Setup</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Support</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../support/community-channels/">Community channels</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Concepts</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../concepts/core-concepts/">Core Concepts</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../concepts/glossary/">Glossary</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Cogment</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="#">Tutorial</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../introduction/">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../1-bootstrap-and-data-structures/">Step 1: Bootstrap a Cogment app</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../2-random-player/">Step 2: Implement actor and environment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../3-rewards/">Step 3: Introduce rewards</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Step 4: Create a heuristic player</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#creating-a-second-actor-implementation">Creating a second actor implementation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#implementing-a-simple-heuristics-agent">Implementing a simple heuristic's agent</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../5-human-player/">Step 5: Add a human player in the loop</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../cogment-api-guide/">Cogment API Guide</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Cogment API Reference</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cogment-api-reference/cogment-yaml/">cogment.yaml</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cogment-api-reference/python/">python</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cogment-api-reference/javascript/">javascript</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Cogment Low Level API Guide</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cogment-low-level-api-guide/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cogment-low-level-api-guide/grpc/">gRPC API Reference</a>
                </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Deployment Guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../deployment-guide/local-deployement/">Local Deployment</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../license/">License</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Cogment</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Tutorial &raquo;</li>
        
      
        
          <li>Cogment &raquo;</li>
        
      
    
    <li>Step 4: Create a heuristic player</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="step-4-add-a-second-actor-implementation-based-on-a-heuristic">Step 4: Add a second actor implementation based on a heuristic</h1>
<blockquote>
<p>This part of the tutorial follows <a href="../3-rewards/">step 3</a>, make sure you've gone through it before starting this one. Alternatively the completed step 2 can be retrieved from the <a href="https://github.com/cogment/cogment-tutorial-rps">tutorial's repository</a>.</p>
</blockquote>
<p>In this step of the tutorial, we will go over another actor implementation and learn about using the received observations before doing an action.</p>
<h2 id="creating-a-second-actor-implementation">Creating a second actor implementation</h2>
<p>Let's start by creating another implementation of the <code>player</code> actor class. Because we expect it to be rather small and not use additional dependencies, this second implementation will <em>live</em> in the same service as the previous one. We will start by copying the <code>random_agent</code> implementation.</p>
<p>In <code>random_agent/main.py</code> copy/paste the <code>random_agent</code> function and name it <code>heuristic_agent</code>.</p>
<pre><code class="python">async def heuristic_agent(actor_session):
</code></pre>

<p>Then, in the same file, register this "new" implementation in the <code>main</code> function.</p>
<pre><code class="python">context.register_actor(
  impl=heuristic_agent,
  impl_name=&quot;heuristic_agent&quot;,
  actor_classes=[&quot;player&quot;])
</code></pre>

<p>When the service starts it will now host the two implementations.</p>
<p>We can now configure one of the <code>player</code> in the default trial, defined in <code>cogment.yaml</code>, to use the <code>heuristic_agent</code> implementation.</p>
<pre><code class="yaml">actors:
  - name: player_1
    actor_class: player
    implementation: random_agent
    endpoint: grpc://random-agent:9000
  - name: player_2
    actor_class: player
    implementation: heuristic_agent
    endpoint: grpc://random-agent:9000
</code></pre>

<p>Modify the <code>cogment.yaml</code> file to include the above addition.</p>
<p>You can now <a href="../1-bootstrap-and-data-structures/#building-and-running-the-app">build and run</a> the application to check that it still works. Nothing should have changed except one of the player uses the code from the new implementation.</p>
<h2 id="implementing-a-simple-heuristics-agent">Implementing a simple heuristic's agent</h2>
<p>While the <code>random_player</code> ignored the state of the game, picking its move at random, our new implementation will consider the received <strong>observations</strong> to pick its move.</p>
<p>We will implement a subset of the strategies described in <a href="https://towardsai.net/p/artificial-intelligence/towards-an-ai-for-rock-paper-scissors-3fb05780271f">this</a> article:</p>
<ul>
<li>If I won the last round, do the same thing,</li>
<li>If my opponent won the last round, play the move that would have won against his,</li>
<li>If the last round was a draw, play a random move.</li>
</ul>
<p>We will start by redefining in <code>random_agent/main.py</code> the same <code>DEFEATS</code> we used by the environment.</p>
<pre><code class="python">DEFEATS = {
  ROCK: PAPER,
  SCISSORS: ROCK,
  PAPER: SCISSORS
}
</code></pre>

<p>Then, in the event loop, we look at the received observation before taking an action based on this simple strategy.</p>
<pre><code class="python">observation = event.observation
print(f&quot;'{actor_session.name}' received an observation: '{observation}'&quot;)
if event.type == cogment.EventType.ACTIVE:
    if observation.me.won_last:
        # I won the last round, let's play the same thing
        actor_session.do_action(PlayerAction(move=observation.me.last_move))
    elif observation.them.won_last:
        # I lost the last round, let's play what would have won
        actor_session.do_action(PlayerAction(move=DEFEATS[observation.them.last_move]))
    else:
        # last round was a draw, let's play randomly
        actor_session.do_action(PlayerAction(move=random.choice(MOVES)))
</code></pre>

<p>Modify the <code>random_player/main.py</code> file accordingly.</p>
<p>You can now <a href="../1-bootstrap-and-data-structures/#building-and-running-the-app">build and run</a> the application to check that it works. Don't expect the heuristic player to beat the random player, the nature of the game actually rewards pure randomness in the playing. You can however implement various strategies and see how they fare against each other.</p>
<p>This concludes the step 4 of the tutorial: you've learned about adding and using different implementations of an actor class and how to access and use the received observations.</p>
<p>Letâ€™s move on to adding a human player in the mix with <a href="../5-human-player/">step 5</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../5-human-player/" class="btn btn-neutral float-right" title="Step 5: Add a human player in the loop">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../3-rewards/" class="btn btn-neutral" title="Step 3: Introduce rewards"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../3-rewards/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../5-human-player/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
